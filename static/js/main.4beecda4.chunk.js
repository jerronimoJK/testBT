(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(22)},15:function(e,t,n){},17:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},18:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(5),a=n.n(i),c=(n(15),n(0)),u=n(2),s=n(3),h=n(8),d=n(6),l=n(9),f=(n(17),n(18),function(){var e=new TextEncoder("utf-8"),t=new TextDecoder("utf-8");return function(){function n(){Object(u.a)(this,n),this.device=null,this.server=null,this._characteristics=new Map,this._debug=!1,this._connected=!1}return Object(s.a)(n,[{key:"isConnected",value:function(){return this.device&&this.device.gatt.connected&&this._connected}},{key:"connect",value:function(e,t){var n=this;return navigator.bluetooth.requestDevice(e).then(function(e){return n.device=e,n._log('Connected to device named "'+e.name+'" with ID "'+e.id+'"'),e.gatt.connect()}).then(function(e){return n.server=e,Promise.all(Object.keys(t).map(function(r){return e.getPrimaryService(r).then(function(e){return Promise.all(Object.keys(t[r].characteristics).map(function(t){return n._cacheCharacteristic(e,t).then(function(){n._log('Found characteristic "'+t+'"')}).catch(function(e){n._error('Characteristic "'+t+'" NOT found')})})).then(function(){return n._connected=!0})}).then(function(){n._log('Found service "'+r+'"')}).catch(function(e){n._error('Service "'+r+'"')})}))})}},{key:"disconnect",value:function(){var e=this;return new Promise(function(t,n){e.isConnected()?t():n("Device not connected")}).then(function(){return e._log("Device disconnected"),e._connected=!1,e.device.gatt.disconnect()}).catch(function(t){e._error(t)})}},{key:"readCharacteristicValue",value:function(e){var t=this;return new Promise(function(e,n){t.isConnected()?e():n("Device not connected")}).then(function(){var n=t._characteristics.get(e);return n.readValue().then(function(e){return e=e.buffer?e:new DataView(e),t._log("READ",n.uuid,e),e})}).catch(function(e){t._error(e)})}},{key:"writeCharacteristicValue",value:function(e,t){var n=this;return new Promise(function(e,t){n.isConnected()?e():t("Device not connected")}).then(function(){var r=n._characteristics.get(e);return n._log("WRITE",r.uuid,t),r.writeValue(t)}).catch(function(e){n._error(e)})}},{key:"_error",value:function(e){if(!this._debug)throw e;console.debug(e)}},{key:"_log",value:function(e){this._debug&&console.log(e)}},{key:"_cacheCharacteristic",value:function(e,t){var n=this;return e.getCharacteristic(t).then(function(e){n._characteristics.set(t,e)})}},{key:"_decodeString",value:function(e){return t.decode(e)}},{key:"_encodeString",value:function(t){return e.encode(t)}}]),n}()}()),v=n(7),b=n.n(v),p=function(){var e=0,t=15,n=8,r=[{portId:0,channelsId:[0,1]},{portId:1,channelsId:[2,3]},{portId:2,channelsId:[4,5]},{portId:3,channelsId:[6,7]}],o="output",i=0,a=1,h=0,d=255;return function(){function l(e){Object(u.a)(this,l),this.webbluetooth=new f,this.NAME=e||"",this.PORT0=this.TOPLEFT=r[0].portId,this.PORT1=this.BOTTOMLEFT=r[1].portId,this.PORT2=this.TOPRIGHT=r[2].portId,this.PORT3=this.BOTTOMRIGHT=r[3].portId,this.CW=i,this.CCW=a,this.MAX=d,this.SERVICES={},this.keepalive=null,this.ports=[{power:h,direction:i,mode:o,busy:!1},{power:h,direction:i,mode:o,busy:!1},{power:h,direction:i,mode:o,busy:!1},{power:h,direction:i,mode:o,busy:!1}],this.maxConcurrent=1,this.maxQueue=1/0,this.queue=new b.a(this.maxConcurrent,this.maxQueue),this._debug=!1}return Object(s.a)(l,[{key:"connect",value:function(){var e,t,n,r=this;this.SERVICES=(n={},Object(c.a)(n,"device_information",{name:"Device Information",characteristics:(e={},Object(c.a)(e,"model_number_string",{name:"Model Number String"}),Object(c.a)(e,"firmware_revision_string",{name:"Firmware Revision String"}),Object(c.a)(e,"hardware_revision_string",{name:"Hardware Revision String"}),Object(c.a)(e,"software_revision_string",{name:"Software Revision String"}),Object(c.a)(e,"manufacturer_name_string",{name:"Manufacturer Name String"}),e)}),Object(c.a)(n,"4dc591b0-857c-41de-b5f1-15abda665b0c",{name:"Remote Control",characteristics:(t={},Object(c.a)(t,"02b8cbcc-0e25-4bda-8790-a15f53e6010f",{name:"Quick Drive"}),Object(c.a)(t,"489a6ae0-c1ab-4c9c-bdb2-11d373c1b7fb",{name:"Remote Control"}),t)}),n);var o={optionalServices:Object.keys(this.SERVICES)};return""!=this.NAME?o.filters=[{namePrefix:[this.NAME]}]:o.acceptAllDevices=!0,this.webbluetooth.connect(o,this.SERVICES).then(function(){r.isConnected()&&(r._debug&&r._log("Connected to SBrick "+r.webbluetooth.device.id),r.getFirmwareVersion().then(function(e){parseFloat(e)>=4.17?r.keepalive=r._keepalive(r):(r._error("Firmware not compatible: please update your SBrick."),r.disconnect())}))}).catch(function(e){r._error(e)})}},{key:"disconnect",value:function(){var e=this;return new Promise(function(t,n){e.isConnected()?t():n("Not connected")}).then(function(){return e.stopAll().then(function(){return clearInterval(e.keepalive),e.webbluetooth.disconnect()})}).catch(function(t){e._error(t)})}},{key:"isConnected",value:function(){return this.webbluetooth&&this.webbluetooth.isConnected()}},{key:"getModelNumber",value:function(){return this._deviceInfo("model_number_string")}},{key:"getFirmwareVersion",value:function(){return this._deviceInfo("firmware_revision_string")}},{key:"getHardwareVersion",value:function(){return this._deviceInfo("hardware_revision_string")}},{key:"getSoftwareVersion",value:function(){return this._deviceInfo("software_revision_string")}},{key:"getManufacturerName",value:function(){return this._deviceInfo("manufacturer_name_string")}},{key:"drive",value:function(e){var t=this;"object"!==typeof e&&(e={portId:arguments[0],direction:arguments[1],power:arguments[2]},this._log("Calling drive with 3 arguments is deprecated: use 1 object {portId, direction, power} instead."));var n=e.portId,c=e.direction||i,u=void 0===e.power?d:e.power;return new Promise(function(e,t){if(void 0!==n&&void 0!==c&&void 0!==u)e();else{var r="Wrong input: please specify ";void 0===n&&(r+="portId"),void 0===u&&(void 0===n&&(r+=" and"),r+=" power"),t(r)}}).then(function(){return t._pvm({portId:n,mode:o})}).then(function(){var e=t.ports[n];e.power=Math.min(Math.max(parseInt(Math.abs(u)),h),d),e.direction=c?a:i,e.busy||(e.busy=!0,t.queue.add(function(){return e.busy=!1,t.webbluetooth.writeCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f",new Uint8Array([1,r[n].portId,e.direction,e.power]))}))}).then(function(){var e=t._getPortData(n);return t._sendPortChangeEvent(e),e}).catch(function(e){t._error(e)})}},{key:"quickDrive",value:function(e){var t=this;return new Promise(function(t,n){Array.isArray(e)?t():n("Wrong input: quickDrive expects array")}).then(function(){var e=[];return t._getPorts().forEach(function(t){e.push({portId:t,mode:o})}),console.log(e),t._pvm(e)}).then(function(){e.forEach(function(e){var n=parseInt(e.portId);isNaN(n)&&(n=parseInt(e.port),t._log("object property port is deprecated. use portId instead."));var r=t.ports[n];r.power=Math.min(Math.max(parseInt(Math.abs(e.power)),h),d),r.direction=e.direction?a:i}),t._portsIdle(t._getPorts())&&(t._setPortsBusy(t._getPorts(),!0),t.queue.add(function(){var e=[];return t.ports.forEach(function(t,n){t.busy=!1,e.push(parseInt(parseInt(t.power/d*127).toString(2)+t.direction,2))}),t.webbluetooth.writeCharacteristicValue("489a6ae0-c1ab-4c9c-bdb2-11d373c1b7fb",new Uint8Array(e))}))}).then(function(){var n=[];return e.forEach(function(e){var r=e.portId;e.port&&(r=parseInt(e.port));var o=t._getPortData(r);t._sendPortChangeEvent(o),n.push(o)}),n}).catch(function(e){t._error(e)})}},{key:"stop",value:function(t){var n=this;return new Promise(function(e,n){null!==t?(Array.isArray(t)||(t=[t]),e()):n("wrong input")}).then(function(){var e=[];return t.forEach(function(t){e.push({portId:t,mode:"break"})}),n._pvm(e)}).then(function(){var r=[];t.forEach(function(e){var t=n.ports[e];t.power=0,t.busy||r.push(e)}),r.length&&(n._setPortsBusy(r,!0),n.queue.add(function(){return n._setPortsBusy(r,!1),n.webbluetooth.writeCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f",new Uint8Array([e].concat(r)))}))}).then(function(){var e=[];return t.forEach(function(t){var r=n._getPortData(t);n._sendPortChangeEvent(r),e.push(r)}),e}).catch(function(e){n._error(e)})}},{key:"stopAll",value:function(){return this.stop(this._getPorts())}},{key:"getBattery",value:function(){return this._volt().then(function(e){return parseInt(Math.abs(e/9*100))})}},{key:"getTemp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._temp().then(function(t){return e?9*t/5+32:t})}},{key:"getSensor",value:function(e,t){var r=this;return new Promise(function(t,n){null!==e?t():n("wrong input")}).then(function(){var t={portId:e,mode:"input"};return"break"===r.ports[e].mode||0!=r.ports[e].power?r.drive(e,i,0).then(function(){return r._pvm(t)}):r._pvm(t)}).then(function(){var o=r._getPortChannels(e);return r._adc([n].concat(o)).then(function(e){for(var n=[],r=0;r<e.byteLength;r+=2)n.push(e.getUint16(r,!0));var o={type:"unknown",voltage:n[0]>>4,ch0_raw:n[1]>>4,ch1_raw:n[2]>>4};switch(t){case"wedo":var i=Math.round(o.ch0_raw/o.voltage*255),a=Math.round(o.ch1_raw/o.voltage*255);o.type=i>=48&&i<=50?"tilt":"motion",o.value=a;break;default:o.value=o.ch1_raw/o.voltage}return o})})}},{key:"invDir",value:function(e){return e?i:a}},{key:"_deviceInfo",value:function(e){var t=this;return new Promise(function(n,r){"undefined"!=typeof t.SERVICES.device_information.characteristics[e]?n():r("Wrong input")}).then(function(){return t.webbluetooth.readCharacteristicValue(e).then(function(e){for(var t="",n=0;n<e.byteLength;n++)t+=String.fromCharCode(e.getUint8(n));return t}).catch(function(e){t._error(e)})}).catch(function(e){t._error(e)})}},{key:"_keepalive",value:function(){var e=this;return setInterval(function(){e.isConnected()?0===e.queue.getQueueLength()&&e.queue.add(function(){return e.webbluetooth.writeCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f",new Uint8Array([t,9]))}):(e._log("Connection lost"),clearInterval(e.keepalive))},300)}},{key:"_adc",value:function(e){var n=this;return this.queue.add(function(){var r=Array.isArray(e)?e:[e];return n.webbluetooth.writeCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f",new Uint8Array([t].concat(r))).then(function(){return n.webbluetooth.readCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f").then(function(e){return e})})})}},{key:"_pvm",value:function(e){var t=this;return new Promise(function(t,n){null!==e?t():n("wrong input")}).then(function(){Array.isArray(e)||(e=[e]);var n=!1;if(e.forEach(function(e){var r=e.portId,o=e.mode;t.ports[r].mode!=o&&(t.ports[r].mode=o,n=!0)}),n){var r=[44],o="";return t.ports.forEach(function(e,n){if("input"==e.mode){var i=t._getPortChannels(n);r.push(i[0]),r.push(i[1]),o+=" PORT"+n+" (CH"+i[0]+" CH"+i[1]+")"}}),t.queue.add(function(){return t.webbluetooth.writeCharacteristicValue("02b8cbcc-0e25-4bda-8790-a15f53e6010f",new Uint8Array(r)).then(function(){t._log("PVM set"+(""==o?" OFF":o))})}),t._delay(500)}return!1})}},{key:"_volt",value:function(){return this._adc(n).then(function(e){var t=e.getInt16(0,!0);return parseFloat(.83875*t/2047)})}},{key:"_temp",value:function(){return this._adc(9).then(function(e){var t=e.getInt16(0,!0);return parseFloat(t/118.85795-160)})}},{key:"_getPorts",value:function(){return r.map(function(e){return e.portId})}},{key:"_getPortChannels",value:function(e){return r[e].channelsId}},{key:"_getPortData",value:function(e){var t=this.ports[e];return{portId:e,direction:t.direction,power:t.power,mode:t.mode}}},{key:"_error",value:function(e){if(!this._debug)throw e;console.debug(e)}},{key:"_log",value:function(e){this._debug&&console.log(e)}},{key:"_delay",value:function(e){return new Promise(function(t){setTimeout(t,e)})}},{key:"_sendPortChangeEvent",value:function(e){var t=new CustomEvent("portchange.sbrick",{detail:e});document.body.dispatchEvent(t)}},{key:"_portsIdle",value:function(e){var t=this,n=!0;return e.forEach(function(e){t.ports[e].busy&&(n=!1)}),n}},{key:"_setPortsBusy",value:function(e,t){var n=this;e.forEach(function(e){n.ports[e].busy=t})}}]),l}()}(),g=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).connectBt=function(){var e,t,n,r=(n={},Object(c.a)(n,"device_information",{name:"Device Information",characteristics:(e={},Object(c.a)(e,"model_number_string",{name:"Model Number String"}),Object(c.a)(e,"firmware_revision_string",{name:"Firmware Revision String"}),Object(c.a)(e,"hardware_revision_string",{name:"Hardware Revision String"}),Object(c.a)(e,"software_revision_string",{name:"Software Revision String"}),Object(c.a)(e,"manufacturer_name_string",{name:"Manufacturer Name String"}),e)}),Object(c.a)(n,"4dc591b0-857c-41de-b5f1-15abda665b0c",{name:"Remote Control",characteristics:(t={},Object(c.a)(t,"02b8cbcc-0e25-4bda-8790-a15f53e6010f",{name:"Quick Drive"}),Object(c.a)(t,"489a6ae0-c1ab-4c9c-bdb2-11d373c1b7fb",{name:"Remote Control"}),t)}),n),o={acceptAllDevices:!0,optionalServices:["4dc591b0-857c-41de-b5f1-15abda665b0c"]};console.log("Requesting Bluetooth Device..."),navigator.bluetooth.requestDevice(o,r).then(function(e){return console.log("id:",e.id,"name:",e.name),e.gatt.connect()}).then(function(e){return console.log("getting services",e),e.getPrimaryService("4dc591b0-857c-41de-b5f1-15abda665b0c")}).then(function(e){return console.log(e),e.getCharacteristics()}).then(function(e){console.log(e[0])})},n.disconnectBt=function(e){n.SBRICK2.disconnect()},n.getCharacteristic2=function(){n.SBRICK2.connect().then(function(){return console.log("connect")})},n.start1=function(e){n.SBRICK2.drive(0,n.SBRICK2.CW,e)},n.start2=function(e){n.SBRICK2.drive(0,n.SBRICK2.CW,e)},n.start3=function(e){n.SBRICK2.drive(0,n.SBRICK2.CW,e)},n.stop=function(){n.SBRICK2.drive(0,n.SBRICK2.CW,0)},n.handleOnChange=function(e){n.setState({value1:e.target.value}),console.log(e.target.value);var t=e.target.value<0?n.SBRICK2.CCW:n.SBRICK2.CW;n.SBRICK2.drive(1,t,e.target.value)},n.handleOnChangeS1=function(e){n.setState({value2:e.target.value}),console.log(e.target.value);var t=e.target.value<0?n.SBRICK2.CW:n.SBRICK2.CCW;n.SBRICK2.drive(3,t,e.target.value)},n.handleOnChange2=function(e){n.SBRICK2.drive(3,n.SBRICK2.CW,e.target.value)},n.setSbrick1=function(e){n.SBRICK2.drive(1,n.SBRICK2.CW,e)},n.setSbrick2=function(e){n.SBRICK2.drive(3,n.SBRICK2.CW,e)},n.state={value1:0,value2:0},n.SBRICK2=new p("SBrick"),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){console.log("mount")}},{key:"render",value:function(){var e=this;console.log("render");var t={transformOorigin:"75px 75px",transform:"rotate(-90deg)",boxShadow:"inset 0px 1px 3px rgba(0, 0, 0, 0.3)",height:"20px !important",width:"200px"};return o.a.createElement("div",{className:"App"},o.a.createElement("div",{style:{margin:"0 0 100px 0 "}},o.a.createElement("p",null,"BT TEST"),o.a.createElement("button",{onClick:function(){return e.start3(255)}},"lights on"),o.a.createElement("button",{onClick:function(){return e.stop()}},"lights off"),o.a.createElement("button",{onClick:function(){return e.getCharacteristic2()}},"connect Sbrick")),o.a.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},o.a.createElement("div",{style:{width:"30%"}},o.a.createElement("input",{style:t,name:"SBrick2",type:"range",min:"-255",max:"255",value:this.state.value2,onChange:this.handleOnChangeS1,onTouchEnd:function(){e.setSbrick2(0),e.setState({value2:0})},onMouseUp:function(){e.setSbrick2(0),e.setState({value2:0})}})),o.a.createElement("div",{style:{width:"30%"}},o.a.createElement("input",{style:t,name:"SBrick",type:"range",min:"-255",max:"255",value:this.state.value1,onChange:this.handleOnChange,onTouchEnd:function(){e.setSbrick1(0),e.setState({value1:0})},onMouseUp:function(){e.setSbrick1(0),e.setState({value1:0})}}))))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,2,1]]]);
//# sourceMappingURL=main.4beecda4.chunk.js.map